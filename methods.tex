% -*- root: article.tex -*-
Conduzimos um estudo qualitativo e explorat\'orio onde os dados foram coletados atrav\'es de um question\'ario online com desenvoveldores Android. Esta se\c{c}\~ao descreve de forma detalhada a estrutura do question\'ario, os participantes e o an\'alise realizada sob as respostas do question\'ario.

\subsection{Question\'ario}
\label{sub:questionario}

O question\'ario continha 25 quest\~oes subdivididas em tr\^es se\c{c}\~oes: a primeira se\c{c}\~ao continha 6 perguntas demogr\'aficas, a segunda se\c{c}\~ao continha 16 perguntas sobre boas e m\'as pr\'aticas relacionadas ao \textit{front-end} Android e a terceira se\c{c}\~ao continha 3 perguntas, 2 para obter \'ultimos pensamentos sobre boas e m\'as pr\'aticas e 1 \'ultima solicitando email caso o participante tivesse interesse em etapas futuras da pesquisa. O question\'ario foi escrito em ingl\^es por\'em informava o participante que respostas em ingl\^es ou portugu\^es eram aceitas. Antes da divulga\c{c}\~ao, realizamos um piloto com 3 desenvolvedores Android. Todos estes dados est\~ao dispon\'iveis no nosso pacote de replica\c{c}\~ao\footnote{https://github.com/SuelenGC/android-code-smells-article}.

A primeira se\c{c}\~ao continha 6 quest\~oes demogr\'aficas obrigat\'orias de multipla escolha. Abordavam sobre idade (18 ou menos, 19 a 24, 25 a 34 e assim por diante at\'e 55 ou mais), estado de resid\^encia (foi dada uma lista com estados do Brasil, Estados Unidos e Europa), anos de experi\^encia com desenvolvimento de software, (1 anos ou menos, 2 anos, 3 anos, e assim por diante at\'e 10 ou mais), anos de experi\^encia com desenvolvimento Android (mesma escala de anos da quest\~ao anterior), uma quest\~ao sobre linguagens que o participante se considerava proeficiente (Java, Python, Ruby, Android, dentre outras) e sobre o \'ultimo grau de escolaridade (estudante de bacharelado, bacharelado, mestrado, doutorado). As quest\~oes sobre idade, regi\~ao, linguagens e grau de escolaridade continham a op\c{c}\~ao ``outros'' onde possibilitava que o participante inserisse sua resposta de forma manual.

A segunda se\c{c}\~ao continha 16 quest\~oes opcionais e dissertativas sobre boas e m\'as pr\'aticas relacionadas ao \textit{front-end} Android. Para cada elemento do \textit{front-end} Android foram feitas duas perguntas, uma sobre boas e outra sobre m\'as pr\'aticas percebidas pelos participantes. Por exemplo, para a \textsc{Activity} as perguntas foram:

\begin{itemize} 
	\item[$\textasteriskcentered$] Do you have any good practices to deal with Activities?
	\item[$\textasteriskcentered$] Do you have any bad practices to deal with Activities? 
\end{itemize}

A terceira se\c{c}\~ao continha 3 perguntas opcionais e dissertativas, 2 para captar qualquer \'ultima ideia sobre boas e m\'as pr\'aticas n\~ao captadas nas quest\~oes anteriores e 1 opcional onde solicitamos o email do participante caso o mesmo tivesse interesse em participar de etapas futuras da pesquisa. As perguntas sobre boas e m\'as pr\'aticas foram as a seguir: 

\begin{itemize} 
	\item[$\textasteriskcentered$] Are there any other *GOOD* practices in Android Presentation Layer we did not asked you or you did not said yet?
	\item[$\textasteriskcentered$] Are there any other *BAD* practices in Android Presentation Layer we did not asked you or you did not said yet?
\end{itemize}

Antes da divulga\c{c}\~ao, realizamos um piloto com 3 desenvolvedores Android e com o feedback deles fizemos alguns ajustes relacionados a obrigatoriedade das perguntas da segunda se\c{c}\~ao do question\'ario, onde todas tornaram-se opcionais. As respostas dos participantes piloto foram desconsideradas para efeitos de vi\'es. 

\subsection{Participantes}
\label{sub:participantes}

O question\'ario foi divulgado em redes sociais como Facebook, Twitter e Linkedin, em grupos de discuss\~ao sobre Android como \href{https://groups.google.com/forum/#!forum/androidbrasil-dev}{\textit{Android Dev Brasil}}, \href{https://groups.google.com/forum/\#!forum/android-brasil-projetos}{\textit{Android Brasil Projetos}} e o grupo do \href{http://slack.androiddevbr.org/}{\textit{Slack Android Dev Br}}, maior grupo de desenvolvedores Android do Brasil com 2622 participantes at\'e o momento da escrita deste artigo. 

O question\'ario esteve aberto por aproximadamente 4 meses, de 9 de Outubro de 2016 at\'e 18 de Janeiro de 2017. Recebemos um total de 45 respostas sendo que 41 foram coletadas em Outubro de 2016, 3 no come\c{c}o de Novembro de 2016 e 1 em Janeiro de 2017. Acreditamos que poucas e nenhuma respostas foram coletadas respectivamente, nos meses de Novembro e Dezembro, devido as festas comemorativas de fim de ano. 7 participantes n\~ao responderam nenhumas das questões da segunda e terceira se\c{c}\~ao, tornando suas respostas n\~ao \'uteis a pesquisa. 53\% preencheram seus emails se disponibilizando para futuras etapas da pesquisa, acreditamos que este alto percentual pode indicar um interesse leg\'itimo da comunidade de desenvolvedores Android pelo tema, refor\c{c}ando a relev\^ancia do estudo. 

A primeira se\c{c}\~ao do question\'ario continham quest\~oes demogr\'aficas. Com a an\'alise dessas quest\^oes foi poss\'ivel notar que atingimos com sucesso \textit{desenvolvedores Android com variados n\'iveis de experi\^encia e de diversas regi\~oes}, pois 1) 100\% dos participantes indicaram possuir alguma experi\^encia com desenvolvimento Android, 2) menos de 30\% indicaram possuir 2 anos ou menos de experi\^encia com Android e mais de 70\% indicaram 3 anos ou mais (13\% 4 anos, 6,5\% 5 anos, 15,5\% 6 anos, 4,4\% 7 anos e 4,4\% 8 anos), vale considerar que a plarforma Android completa 10 anos em 2017, ou seja, 5 anos representam 50\% do tempo desta tecnolgia 4) 36 respostas foram do Brasil, 7 de pa\'ises europeus e 1 dos Estados Unidos (Calif\'ornia). Estes dados est\~ao sumarizados na Tabela \ref{tab:DadosDemograficos}.

\begin{table}[h]
\centering
\caption{Experi\^encia dos participantes com desenvolvimento Android.}
\begin{tabular}{c|c}
Experi\^encia com Android & Total de Participantes \\
\hline
at\'e 1 ano 	&	6 (13,33\%) \\
2 anos 			& 	 7 (15,56\%) \\
3 anos 			& 	 12 (26,67\%) \\
4 anos 			& 	 6 (13,33\%) \\
5 anos 			& 	 3 (6,67\%) \\
6 anos 			& 	 7 (15,56\%) \\
7 anos 			& 	 2 (4,44\%) \\
8 anos 			& 	 2 (4,44\%) \\

\end{tabular}
\label{tab:DadosDemograficos}
\end{table}

% \begin{tikzpicture}
% \begin{axis}[
%     ybar,
%     enlargelimits=0.15,
%     legend style={at={(0.5,-0.15)},
%       anchor=north,legend columns=-1},
%     ylabel={participantes},
%     symbolic x coords={1-2 anos,2-5 anos,6-10 anos},
%     xtick=data,
%     nodes near coords,
%     nodes near coords align={vertical},
%     ]
% \addplot coordinates {(1-2 anos,5) (2-5 anos,10) (6-10 anos,30)};
% \addplot coordinates {(1-2 anos,13) (2-5 anos,21) (6-10 anos,11)};
% \legend{experi\^encia com software,experi\^encia com Android}
% \end{axis}
% \end{tikzpicture}

\subsection{An\'alise dos Dados}
\label{sub:smells-definition}

O processo de análise das respostas do questionário se deu em 3 passos: verticaliza\c{c}\~ao, limpeza dos dados e codifica\c{c}\~ao t\'opica e divis\~ao. A an\'alise partiu da listagem das 45 respostas do question\'ario. A partir desta listagem realizamos o processo que denominamos como verticaliza\c{c}\~ao, ou seja, cada resposta de boa ou m\'a pr\'atica se tornou um registro individual a ser analisado, resultando em 810 respostas sobre boas ou m\'as pr\'aticas em algum elemento do \textit{front-end} Android. O n\'umero 810 refere-se as 18 perguntas sobre boas e m\'as pr\'aticas multiplicado pelos 45 participantes.

Nosso segundo foi realizar a limpeza dos dados. Essa etapa consistiu em remover respostas obviamente n\~ao \'uteis como respostas em branco, que continham frases como \textit{"N\~ao"}, \textit{"N\~ao que eu saiba"}, \textit{"Eu n\~ao me lembro"} e similares, as consideradas vagas como \textit{"Eu n\~ao tenho certeza se s\~ao boas praticas mas uso o que vejo por ai"}, as consideradas gen\'ericas como \textit{"Como todo c\'odigo java..."} e as que n\~ao eram relacionadas a boas pr\'aticas de c\'odigo. Das 810 boas e m\'as pr\'aticas, 352 foram consideradas e 458 desconsideradas. Das 352, 44,6\% foram apontadas como m\'as pr\'aticas e 55,4\% como boas pr\'aticas. 

Em seguida realizamos a codifica\c{c}\~ao sobre as boas e más práticas. Durante esse processo, categorias foram emergindo a partir das respostas. Durante a codifica\c{c}\~ao, houveram 30 respostas que n\~ao eram triviais de identificar uma categoria ou mesmo de dizer se essas respostas deveriam ser consideradas, sendo marcadas como \textit{"talvez"} durante o processo e reavaliadas ao final, onde 6 permaneceram e 24 foram desconsideradas. Uma situa\c{c}\~ao interessante \'e que diversas dessas respostas indicavam que n\~ao se deve usar \textsc{Fragments} por\'em n\~ao apresentavam nenhum argumento sobre o motivo, por exemplo: ``Eu tento evit\'a-los.' (tradu\c{c}\~ao livre). Essas respostas inicialmente seriam desconsideradas, mas pela quantidade de repeti\c{c}\~oes obtidas, 10 no caso, optamos por considerar. Tamb\'em durante a codifica\c{c}\~ao, 9 respostas incialmente consideradas, foram desconsideradas. Para toda resposta desconsiderada foi indicado um motivo. Ao final da categoriza\c{c}\~ao, 313 boas e m\'as pr\'aticas foram de fato consideradas.

% Em seguida, realizamos diversas itera\c{c}\~oes nas respostas sobre boas e m\'as pr\'aticas consideradas a fim de categoriz\'a-las em algum novo smell Android ou algum smell pr\'e-existente. Essas itera\c{c}\~oes consistiram em analisar resposta a resposta e atribuir uma ou mais categorias de algum poss\'ivel novo smell Android ou pr\'e-existente. Foram realizadas diversas itera\c{c}\~oes de categoriza\c{c}\~ao com o objetivo de normalizar as categorias, ou seja, evitar sin\^onimos e hom\^onimos. Um sin\^onimo \'e o mesmo conceito com dois nomes diferentes e hom\^onimos s\~ao dois conceitos diferentes com o mesmo nome. 

% Durante a categoriza\c{c}\~ao, uma mec\^anica que consideramos importante para a normaliza\c{c}\~ao das categorias, foi a cria\c{c}\~ao de uma lista de categorias, onde a cada nova categoria atribu\'ida, increment\'avamos a lista e preench\'iamos com descri\c{c}\~oes que indicavam que tipo de boa ou m\'a pr\'atica estava recebendo aquela categoria. Esta mec\^anica ajudou a evitar hom\^onimos e sin\^onimos e serviu como base para a defini\c{c}\~ao e avalia\c{c}\~ao da relev\^ancia dos \textit{smells} a serem trabalhados nos pr\'oximos passos.

Nosso último passo foi a etapa de divis\~ao, ou seja, as respostas que receberam mais de uma categoria foram divididas em duas ou mais respostas, de acordo com o n\'umero de categorias identificadas. Por exemplo, a resposta \textit{"N\~ao fazer Activities serem callbacks de execu\c{c}\~oes ass\'incronas. Herdar sempre das classes fornecidas pelas bibliotecas de suporte, nunca diretamente da plataforma"} indica na primeira ora\c{c}\~ao a categoria de smell que denominamos \textbf{Zumbi Referended Activity} e na segunda ora\c{c}\~ao, a categoria de smell \textbf{Inherit From Support Library Always}. Ao divid\'i-la mantivemos o texto da resposta apenas relativo a categoria, como se fossem duas respostas v\'alidas. Em algumas respostas que foram divididas n\~ao pudemos dividir o texto pois a resposta completa era necess\'ario para entender ambas as categoriza\c{c}\~oes, nesses casos, mantivemos a resposta original, mesmo que duplicada, e categorizamos cada uma de forma diferente. Ap\'os estas divis\~oes, as 313 respostas iniciais se tornaram 388 sendo cada uma com apenas uma categoria de \textit{smell}. 

Ao final de todas as etapas, conclu\'imos com 388 respostas sobre boas e m\'as pr\'aticas distribu\'idas em 47 categorias. 

\subsection{An\'alise e Defini\c{c}\~ao dos Smells}
\label{sub:analisys-definition}

Nosso objetivo nesta etapa foi entender quais \textit{smells}, dos 47 identificados, eram mais recorr\^entes. Para isso, contabilizamos cada \textit{smell}, em quantas respostas ele aparecia, ou seja, se duas respostas foram categorizadas com o \textit{smell} "A" ent\~ao diz-se que esse \textit{smell} tem contagem 2. Depois da contagem, elaboramos intervalos que indicam recorr\^encia ALTA, maior ou igual a 20, M\'EDIA, dentre 6 e 19 e BAIXA, dentre 3 e 5. Abaixo de 3 classificamos como IRRELEVANTE. Obtemos o seguinte resultado:

\begin{table}[h]
\centering
\caption{Smells identificados vs. recorr\^encia percebida pelos participantes do question\'ario}
\begin{tabular}{p{3cm}|p{4cm}}
\textbf{Recorr\^encia} & \textbf{Quantidade de Smells} \\
\hline
Alta  			& 5 \\
M\'edia 		& 17 (1 \textit{smell} tradicional) \\
Baixa			& 5 \\
Irrelevante 	& 20 \\
\end{tabular}
\label{tab:DadosDemograficos2}
\end{table}

Os irrelevantes foram desconsiderados nesta etapa de defini\c{c}\~ao. Os demais foram definidos com a ajuda das respostas dos participantes. Para cada \textit{smell} definimos os seguintes t\'opicos: 

\begin{itemize} 
	\item[$\textasteriskcentered$] \textbf{Quando ocorre}. Indicamos os motivos pelo qual foi considerado uma m\'a pr\'atica.   
	\item[$\textasteriskcentered$] \textbf{Contexto/exemplo}. Indicamos algum exemplo ou contexto pr\'atico. 
	\item[$\textasteriskcentered$] \textbf{Elementos afetados}. Eventualmente algum \textit{smell} afeta mais de um elemento, nesse t\'opico abordamos em quais os elementos este \textit{smell} pode estar presente. 
	\item[$\textasteriskcentered$] \textbf{Solu\c{c}\~ao}. Indicamos poss\'iveis refatora\c{c}\~oes para reduzir ou eliminar o \textit{smell}. \\
\end{itemize}

\'E importante ressaltar que todas as defini\c{c}\~oes dos \textit{smells} foram apoiadas nas respostas dos participantes. Se os participantes n\~ao indicaram algum t\'opico para algum \textit{smell}, o mesmo n\~ao foi definido. \\
